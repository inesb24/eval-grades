---
title: "BEZIE"
author: "Inès Bézie"
format: html
---

## Question 1

```{r}
here::i_am("eval-grades.Rproj")
library(here)
grades <- read.csv(here("grades(1).csv"))
library(dplyr)
library(tidyr)
```

## Question 2

```{r}
number_grades <- nrow(grades)
```

The dataset contains `r number_grades` grades.

## Question 3

```{r}
number_students <-
  grades |>
  distinct(id) |>
  nrow()
```

The dataset contains `r number_students` students.

## Question 4

```{r}
students <-
  grades |>
  distinct(id, group)
students |>
  slice_head(n = 7) |>
  knitr::kable()
```

```{r}
library(ggplot2)
students |>
  group_by(group) |>
  summarise(N= n()) |>
  ggplot(aes(x = factor(group), y = N)) +
  geom_col()
```

## Question 6

```{r}
grades |>
  filter(course == "History of the Arcane") |>
  group_by(group) |>
  summarise(avg_grade = sum(grade)/n()) |>
  ggplot(aes(x = group, y = avg_grade)) +
  geom_col()
```

## Question 7

```{r}
grades |>
  group_by(trimester) |>
  summarise(grades_trim = n()) |>
ggplot(aes(x = trimester, y = grades_trim)) + 
  geom_col()
```

## Question 8

```{r}
grades_per_students <-
  grades |>
  group_by(id, group) |>
  summarise(grades_student = n()) |>
  summarise(min_grade = min(grades_student), max_grade = max(grades_student), mean_grade = mean(grades_student), med_grade = median(grades_student)) 
grades_per_students |>
  slice_head(n = 7) |>
  knitr::kable()
```

|               |                  |
|---------------|------------------|
| minimum grade | \`r min_grade\`  |
| maximum grade | \`r max_grade\`  |
| average grade | \`r mean_grade\` |
| median grade  | \`r med_grade\`  |

: Summary of grades per student

## Question 9
```{r}
df_celestial <-
  grades |>
  filter(course == "Celestial Navigation and Astronomy") |>
  group_by(id, group) |>
  summarise(number_cel_grades = n())
df_celestial |>
  slice_head(n = 7) |>
  knitr::kable()
```

## Question 10

```{r}
df_celestial |>
  ungroup() |>
  group_by(number_cel_grades) |>
  summarise(students_nb = n()) |>
  ggplot(aes(x = number_cel_grades, y = students_nb)) + 
  geom_col()
```
## Question 11

```{r}
df_celestial |>
  ggplot(aes(x = factor(group), y = number_cel_grades)) + 
  geom_col()
```

We observe some variability of the number of grades in Celestial Navigation and Astronomy depending on the group the students are in. Groups 1, 8 and 15 have more grades than group 4 for example.

